import{a}from"./chunk-3JPVQHOR.mjs";import{spawn as n}from"child_process";import c from"tree-kill";var i=class{constructor(){this.MAXIMUM_WAIT_TIME_SEC=75;this.READINESS_ENDPOINT="http://127.0.0.1:8070/";this.process=null}stop(){this.process?.pid&&c(this.process.pid)}async run(){await this.checkIfProcessIsUp()||(this.start(),await this.waitUntilProcessIsUp())}start(){let s=n("npx",["aptos","node","run-local-testnet","--force-restart","--assume-yes","--with-indexer-api"]);this.process=s,s.stderr?.on("data",o=>{let e=o.toString();console.log(e)}),s.stdout?.on("data",o=>{let e=o.toString();console.log(e)})}async waitUntilProcessIsUp(){let t=await this.checkIfProcessIsUp(),r=Date.now()/1e3,s=r;for(;!t&&r+this.MAXIMUM_WAIT_TIME_SEC>s;)await a(1e3),t=await this.checkIfProcessIsUp(),s=Date.now()/1e3;if(!t)throw new Error("Process failed to start");return!0}async checkIfProcessIsUp(){try{return(await fetch(this.READINESS_ENDPOINT)).status===200}catch{return!1}}};export{i as a};
//# sourceMappingURL=chunk-L54P6EGN.mjs.map